<html>
<!--EVERYTHING needs to be here or off-server since only routing this one static file-->
<h1>Monai Proxy Login</h1>
<label for="username">Username: </label>
<input type="text" id="username" placeholder="username"></input>
<label for="password">Password: </label>
<input type="password" id="password"></input>
<button onclick="handleLogin()" type="button" id="login">Log in</button>

<script>
  function createCookie(name,value,minutes) {
      if (minutes) {
          var date = new Date();
          date.setTime(date.getTime()+(minutes*60*1000));
          var expires = "; expires="+date.toGMTString();
      } else {
          var expires = "";
      }
      document.cookie = name+"="+value+expires+"; path=/";
  }

  function handleLogin(){
    let username = document.getElementById("username").value
    let password = document.getElementById("password").value
    let body = {username: username, password: password}
    fetch("./login"{
      method: "POST",
      body: JSON.stringify(body)
    }).then(x=>x.json()).then(data=>{
      createCookie("token", data['token'], 60);
      // TODO handle a redir path in query params
      window.location = "./"
    }).catch(e=>{
      console.error(e)
      alert("Login failed")
    })
  }
</script>
</html>
